{% extends "base.html" %}
{% load static %}

{% block title %}Регистрация{% endblock %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
{% endblock %}

{% block content %}
<div class="content">
    <div class="hello-text">
        <h1>Зарегистрироваться</h1>
        <form id="registrationForm" method="post" class="form">
            {% csrf_token %}
            <div class="field">
                <label for="email" class="email-label">Электронная почта</label>
                <input type="email" id="email" name="newEmail" class="input-field" placeholder="Введите вашу электронную почту" required>
            </div>
            <div class="field">
                <label for="name" class="name-label">Имя</label>
                <input type="text" id="name" name="newName" class="input-field" placeholder="Введите ваше имя" required>
            </div>
            <div class="field">
                <label for="password" class="password-label">Пароль</label>
                <input type="password" id="password" name="newPassword" class="input-field" placeholder="Введите ваш пароль" required>
            </div>
            <button type="submit" class="login-button">Зарегистрироваться</button>
        </form>

        <div class="auth">
            <p class="text-btn">Уже есть аккаунт?</p>
            <a href="{% url 'login' %}" class="sign-in">Войти →</a>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    document.getElementById('registrationForm').addEventListener('submit', async function(event) {
        event.preventDefault();
        const formData = new FormData(this);
        try {
            const response = await axios.post('{% url "register" %}', formData);
            if (response.status === 200) {
                alert('Регистрация прошла успешно. Пользователь создан.');
                window.location.href = '{% url "login" %}';
            } else {
                alert('Ошибка при регистрации: ' + response.data.message);
            }
        } catch (error) {
            alert('Ошибка при отправке данных: ' + error.message);
        }
    });
</script>
{% endblock %}
